<div class="container mt-4">
  <form [formGroup]="itemForm" (ngSubmit)="onSubmit()" class="shadow-lg p-4 m-2">
    <h2 class="mb-4">Edit Item</h2>
    <div class="row g-3">

      <!-- Name -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name">
          <mat-error *ngIf="itemForm.get('name')?.invalid && itemForm.get('name')?.touched">
            Name is required and must be at least 2 characters.
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Category -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Category</mat-label>
          <mat-select formControlName="category">
            <mat-option value="Vegetable">Vegetable</mat-option>
            <mat-option value="Fruit">Fruit</mat-option>
            <mat-option value="Organic">Organic</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Price -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Price ($)</mat-label>
          <input matInput type="number" step="0.01" formControlName="price">
        </mat-form-field>
      </div>

      <!-- Discount Price -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Discount Price ($)</mat-label>
          <input matInput type="number" step="0.01" formControlName="discountPrice">
        </mat-form-field>
      </div>

      <!-- Quantity -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Quantity</mat-label>
          <input matInput type="number" step="0.01" formControlName="quantity">
        </mat-form-field>
      </div>

      <!-- Quantity Unit -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Quantity Unit</mat-label>
          <mat-select formControlName="quantityUnit">
            <mat-option value="500 gms">500 gms</mat-option>
            <mat-option value="1 kg">1 kg</mat-option>
            <mat-option value="2 kg">2 kg</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Shop Name -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Shop Name</mat-label>
          <input matInput formControlName="shopName">
        </mat-form-field>
      </div>

      <!-- Image URL/File -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Image URL</mat-label>
          <input matInput formControlName="imageUrl">
        </mat-form-field>

        <div class="mt-2">
          <label for="fileInput">Choose a file:</label>
          <input type="file" id="fileInput" class="form-control" (change)="onFileSelected($event)">
        </div>

        <div *ngIf="previewImageUrl" class="mt-2">
          <img [src]="previewImageUrl" alt="Preview" style="max-width: 100px; max-height: 100px; object-fit: cover; border: 1px solid #ccc;">
        </div>
      </div>

      <!-- Details -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Details</mat-label>
          <textarea matInput formControlName="details" rows="3"></textarea>
        </mat-form-field>
      </div>

      <!-- Additional Details -->
      <div class="col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Additional Details</mat-label>
          <textarea matInput formControlName="additionalDetails" rows="3"></textarea>
        </mat-form-field>
      </div>

      <!-- Submit -->
      <div class="col-12 d-flex gap-2 justify-content-end">
        <button mat-flat-button color="primary" type="submit" [disabled]="itemForm.invalid || isSubmitting">
          Update
        </button>
        <button mat-stroked-button type="button" (click)="onCancel()" [disabled]="isSubmitting">
          Cancel
        </button>
      </div>
    </div>
  </form>
</div>
