<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-body">

      <div *ngIf="currentUser; else notLoggedIn">
        <h2 class="mb-4">My Profile</h2>

        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">

          <!-- Full Name -->
          <div class="form-group mb-3">
            <label>Full Name</label>
            <input type="text" class="form-control" formControlName="fullName" [readonly]="!isEditing">
            <div *ngIf="profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched" class="text-danger">
              Full Name is required (min 2 characters)
            </div>
          </div>

          <!-- Email -->
          <div class="form-group mb-3">
            <label>Email</label>
            <input type="email" class="form-control" formControlName="email" [readonly]="!isEditing">
            <div *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-danger">
              Valid email is required
            </div>
          </div>

          <!-- Password -->
          <div class="form-group mb-3" *ngIf="isEditing">
            <label>Password (leave blank to keep current)</label>
            <div class="input-group">
              <input [type]="showPassword ? 'text' : 'password'" class="form-control" formControlName="password">
              <div class="input-group-append">
                <button type="button" class="btn btn-outline-secondary" (click)="togglePasswordVisibility()">
                  {{ showPassword ? 'Hide' : 'Show' }}
                </button>
              </div>
            </div>
          </div>

          <!-- Buttons -->
          <div class="mt-3">
            <button type="button" class="btn btn-secondary me-2" (click)="toggleEdit()">
              {{ isEditing ? 'Cancel' : 'Edit Profile' }}
            </button>
            <button type="submit" class="btn btn-primary" *ngIf="isEditing" [disabled]="isLoading">
              {{ isLoading ? 'Saving...' : 'Save Changes' }}
            </button>
            <button type="button" class="btn btn-danger ms-2" (click)="logout()">Logout</button>
          </div>

        </form>
      </div>

      <ng-template #notLoggedIn>
        <div class="text-center py-5">
          <h4>You are not logged in</h4>
          <a routerLink="/auth/login" class="btn btn-primary mt-3">Login</a>
        </div>
      </ng-template>

    </div>
  </div>
</div>
