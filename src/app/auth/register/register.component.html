<div id="main-wrapper" class="container-fluid mt-3 shadow-sm">
  <div class="row justify-content-center">
    <div class="col-xl-10">
      <div class="card border-0">
        <div class="card-body p-0">
          <div class="row no-gutters">
            <!-- Form Section -->
            <div class="col-lg-6">
              <div class="p-5">
                <div class="mb-5">
                  <h1 class="h4 font-weight-bold text-theme">Register</h1>
                </div>
                <h6 class="h5 mb-0">Create your account</h6>
                <p class="text-muted mt-2 mb-5">Fill in the details below to create your admin account.</p>

                <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
                  <!-- Full Name -->
                  <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" class="form-control" id="fullName" formControlName="fullName">
                    <div *ngIf="registerForm.get('fullName')?.invalid && registerForm.get('fullName')?.touched" class="text-danger">
                      <div *ngIf="registerForm.get('fullName')?.errors?.['required']">Full Name is required.</div>
                      <div *ngIf="registerForm.get('fullName')?.errors?.['minlength']">Full Name must be at least 2 characters.</div>
                    </div>
                  </div>

                  <!-- Email -->
                  <div class="form-group">
                    <label for="regEmail">Email address</label>
                    <input type="email" class="form-control" id="regEmail" formControlName="email" autocomplete="email">
                    <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="text-danger">
                      <div *ngIf="registerForm.get('email')?.errors?.['required']">Email is required.</div>
                      <div *ngIf="registerForm.get('email')?.errors?.['email']">Invalid email format.</div>
                    </div>
                  </div>

                  <!-- Password -->
                  <div class="form-group">
                    <label for="regPassword">Password</label>
                    <div class="input-group">
                      <input 
                        [type]="showPassword ? 'text' : 'password'" 
                        class="form-control" 
                        id="regPassword" 
                        formControlName="password" 
                        autocomplete="new-password"
                        [ngClass]="{'is-invalid': registerForm.get('password')?.invalid && registerForm.get('password')?.touched}"
                      >
                      <div class="input-group-append">
                        <button type="button" class="fs-4 border" (click)="togglePasswordVisibility()">
                          <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="text-danger mt-1">
                      <div *ngIf="registerForm.get('password')?.errors?.['required']">Password is required.</div>
                      <div *ngIf="registerForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters.</div>
                    </div>
                  </div>

                  <!-- Confirm Password -->
                  <div class="form-group mb-5">
                    <label for="confirmPassword">Confirm Password</label>
                    <div class="input-group">
                      <input 
                        [type]="cShowPassword ? 'text' : 'password'" 
                        class="form-control" 
                        id="confirmPassword" 
                        formControlName="confirmPassword"
                        autocomplete="new-password"
                        [ngClass]="{'is-invalid': (registerForm.get('confirmPassword')?.touched && registerForm.errors?.['mismatch'])}"
                      >
                      <div class="input-group-append">
                        <button type="button" class="fs-4 border" (click)="togglePasswordVisibility1()">
                          <mat-icon>{{ cShowPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div *ngIf="registerForm.get('confirmPassword')?.touched" class="text-danger mt-1">
                      <div *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">Confirm Password is required.</div>
                      <div *ngIf="registerForm.errors?.['mismatch']">Passwords do not match.</div>
                    </div>
                  </div>

                  <!-- Progress Bar -->
                  <div *ngIf="showProgress$ | async" class="mt-3">
                    <mat-progress-bar mode="determinate" [value]="progress$ | async"></mat-progress-bar>
                    <div class="text-center mt-1">{{ progress$ | async }}%</div>
                  </div>

                  <!-- Submit Button -->
                  <button type="submit" class="btn btn-theme btn-block" [disabled]="registerForm.invalid || isLoading">
                    {{ isLoading ? 'Registering...' : 'Register' }}
                  </button>
                </form>
              </div>
            </div>

            <!-- Image/Testimonial Section -->
            <div class="col-lg-6 d-none d-lg-inline-block">
              <div class="account-block rounded-right">
                <div class="overlay rounded-right"></div>
                <div class="account-testimonial">
                  <h4 class="text-white mb-4">Join us today!</h4>
                  <p class="lead text-white">"Creating an account is simple and fast. Start managing your dashboard immediately."</p>
                  <p>- Admin User</p>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <p class="text-muted text-center mt-3 mb-0">
        Already have an account?
        <a routerLink="/auth/login" class="text-primary ml-1">Login</a>
      </p>
    </div>
  </div>
</div>